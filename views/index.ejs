<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>song-recs</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link rel="stylesheet" href="font-awesome.min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>song-recs</h1>
  <main>
    <h3 class="subtext">Add a song recommendation below:</h3>

    <form action="/songs" method="POST">
      <input
        type="text"
        placeholder="Enter username"
        name="username"
        minlength="2"
        required
      />
      <!-- AI generated pattern validation-->
      <input
        type="text"
        placeholder="https://youtube.com/..."
        name="song"
        pattern="https?://(www\.)?(youtube\.com|youtu\.be)/.+"
        title="Please enter a valid YouTube URL"
        required
      />
      <button type="submit">Submit</button>
    </form>


    <section class="songs">
    <% for(var i=0; i<songs.length; i++) {%>
      <article class="song">
        <% const videoId = songs[i].song.split('v=')[1] %>
        <iframe width="300" height="169" data-song="<%= songs[i].song %>"
          src="https://www.youtube.com/embed/<%= videoId %>"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen>
        </iframe>
        <section class="thumb-count" data-song="<%= songs[i].song %>" data-username="<%= songs[i].username %>">
          <span><%= songs[i].thumbUp %></span>
          <span><i class="fa fa-thumbs-up" aria-hidden="true"></i></span>
          <span><i class="fa fa-thumbs-down" aria-hidden="true"></i></span>
          <span><i class="fa fa-trash" aria-hidden="true"></i></span>
        </section>
        <p class="message-date">added on <span><%= new Date(songs[i].createdAt).toLocaleDateString() %></span> by <%= songs[i].username %></p>
      </article>
    <% } %>
    </section>
  </main>

  <footer>
    <a
      href="https://github.com/mau11/song-recs"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Visit Song Recs GitHub Repository"
    >
      <span>
        created by mau
        <img src="/images/github-mark.png" alt="GitHub Logo" />
      </span>
    </a>
  </footer>

  <script src="main.js"></script>
</body>
</html>
