<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Song Recs</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link rel="stylesheet" href="font-awesome.min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Song Recs</h1>
  <main>
    <h3 class="subtext">Add a song recommendation below:</h3>

    <form action="/messages" method="POST">
      <input type="text" placeholder="Enter username" name="username">
      <input type="text" placeholder="https://youtube.com/..." name="message">
      <button type="submit">Submit</button>
    </form>

    <ul class="messages">
    <% for(var i=0; i<messages.length; i++) {%>
      <li class="message">
        <% const videoId = messages[i].message.split('v=')[1] %>
        <iframe width="300" height="169" data-song="<%= messages[i].message %>"
          src="https://www.youtube.com/embed/<%= videoId %>"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen>
        </iframe>
        <div class="thumb-count" data-song="<%= messages[i].message %>" data-username="<%= messages[i].username %>">
          <span><%= messages[i].thumbUp %></span>
          <span><i class="fa fa-thumbs-up" aria-hidden="true"></i></span>
          <span><i class="fa fa-thumbs-down" aria-hidden="true"></i></span>
          <span><i class="fa fa-trash" aria-hidden="true"></i></span>
        </div>
        <p class="message-date">added on <span><%= new Date(messages[i].createdAt).toLocaleDateString() %></span> by <%= messages[i].username %></p>
      </li>
    <% } %>
    </ul>
  </main>

  <footer>
    <a
      href="https://github.com/mau11/song-recs"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Visit Song Recs GitHub Repository"
    >
      <p>
        created by mau
        <img src="/images/github-mark.png" alt="GitHub Logo" />
      </p>
    </a>
  </footer>

  <script src="main.js"></script>
</body>
</html>
